<article class="post reveal" itemscope itemprop="blogPost">
    <div class=post-gallery">
        <style>
            .gallery {
                display: flex;
                flex-wrap: wrap;
                margin: 2px;
            }

            .gallery>div {
                margin: 2px;
                background-color: gray;
                position: relative;
                /* box-shadow: 5px 5px 5px #888888; */
            }

            .gallery>div>i {
                display: block;
                background-color: gray;
                /* display: none; */
            }

            .gallery>div>a>img {
                position: absolute;
                vertical-align: bottom;
                top: 0;
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .gallery>div>img {
                position: absolute;
                vertical-align: bottom;
                top: 0;
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .gallery>div>a>img:hover {
                opacity: 0.5;
                cursor: pointer;
            }

            .gallery>div>img:hover {
                opacity: 0.5;
                cursor: pointer;
            }

            .gallery>.placeholder {
                flex-grow: 100;
                flex-basis: 240px;
                height: 0;
                margin: 0;
            }
        </style>
        <div class="gallery" id="gallery">
        </div>
        <script>
            (function () {
                let pics = [];
                const gallery = document.getElementById('gallery');
                const createElements = pic => {
                    img = document.createElement('img');
                    img.setAttribute("src", pic.url);
                    div = document.createElement('div');
                    divStyle = "flex-grow:" + pic.width * 100 / pic.height + ";flex-basis:" + pic.width * 200 / pic.height + "px;"
                    div.setAttribute('style', divStyle);
                    i = document.createElement('i');
                    iStyle = "padding-bottom:" + pic.height / pic.width * 100 + "%";
                    i.setAttribute("style", iStyle);
                    div.appendChild(i);
                    div.appendChild(img);
                    gallery.appendChild(div);
                };
                const removeElements = elem => {
                    while (elem.firstChild) {
                        elem.removeChild(elem.firstChild);
                    }
                };
                const initialize = () => {
                    removeElements(gallery);
                    pics.forEach(createElements);
                    document.body.scrollTop = 0;
                };

                fetch('./data.json')
                    .then(res => res.json())
                    .then(images => {
                        pics = images.pics;
                        initialize();
                        lazyImage();
                        wrapImage();
                        loadImage();
                        ;
                    });
            }())
        </script>
    </div>
</article>

<script>
    window.subData = {
        title: '<%= post.title %>',
        tools: true
    }
</script>